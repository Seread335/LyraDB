cmake_minimum_required(VERSION 3.20)
project(lyradb_formats)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find required packages
find_package(nlohmann_json QUIET)

# Source files for the library
set(SOURCES
    src/formats/lyradb_formats.cpp
)

# Header files
set(HEADERS
    include/lyradb/lyradb_formats.h
)

# Create static library
add_library(lyradb_formats STATIC ${SOURCES})

# Set include directories
target_include_directories(lyradb_formats PUBLIC
    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
    $<INSTALL_INTERFACE:include>
)

# Set compiler options
if(MSVC)
    target_compile_options(lyradb_formats PRIVATE /W4 /WX)
else()
    target_compile_options(lyradb_formats PRIVATE -Wall -Wextra -Werror)
endif()

# Installation
install(
    TARGETS lyradb_formats
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib
    RUNTIME DESTINATION bin
)

install(
    DIRECTORY include/
    DESTINATION include
)
